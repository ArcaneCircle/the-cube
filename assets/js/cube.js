const X=(()=>{let r=0;class t{constructor(){this.ids=[],this.animations={},this.update=this.update.bind(this),this.raf=0,this.time=0}update(){const s=performance.now(),i=s-this.time;this.time=s;let a=this.ids.length;for(this.raf=a?requestAnimationFrame(this.update):0;a--;)this.animations[this.ids[a]]&&this.animations[this.ids[a]].update(i)}add(s){s.id=r++,this.ids.push(s.id),this.animations[s.id]=s,this.raf===0&&(this.time=performance.now(),this.raf=requestAnimationFrame(this.update))}remove(s){const i=this.ids.indexOf(s.id);i<0||(this.ids.splice(i,1),delete this.animations[s.id],s=null)}}return new t})();class ${constructor(t){t===!0&&this.start()}start(){X.add(this)}stop(){X.remove(this)}update(t){}}class rt extends ${constructor(t){super(!0),this.game=t,this.container=this.game.dom.game,this.scene=new THREE.Scene,this.renderer=new THREE.WebGLRenderer({antialias:!0,alpha:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.container.appendChild(this.renderer.domElement),this.camera=new THREE.PerspectiveCamera(2,1,.1,1e4),this.stage={width:2,height:3},this.fov=10,this.createLights(),this.onResize=[],this.resize(),window.addEventListener("resize",()=>this.resize(),!1)}update(){this.renderer.render(this.scene,this.camera)}resize(){this.width=this.container.offsetWidth,this.height=this.container.offsetHeight,this.renderer.setSize(this.width,this.height),this.camera.fov=this.fov,this.camera.aspect=this.width/this.height;const t=this.stage.width/this.stage.height,e=this.fov*THREE.Math.DEG2RAD;let s=t<this.camera.aspect?this.stage.height/2/Math.tan(e/2):this.stage.width/this.camera.aspect/(2*Math.tan(e/2));s*=.5,this.camera.position.set(s,s,s),this.camera.lookAt(this.scene.position),this.camera.updateProjectionMatrix();const i=t<this.camera.aspect?this.height/100*t:this.width/100;document.documentElement.style.fontSize=i+"px",this.onResize&&this.onResize.forEach(a=>a())}createLights(){this.lights={holder:new THREE.Object3D,ambient:new THREE.AmbientLight(16777215,.69),front:new THREE.DirectionalLight(16777215,.36),back:new THREE.DirectionalLight(16777215,.19)},this.lights.front.position.set(1.5,5,3),this.lights.back.position.set(-1.5,-5,-3),this.lights.holder.add(this.lights.ambient),this.lights.holder.add(this.lights.front),this.lights.holder.add(this.lights.back),this.scene.add(this.lights.holder)}}function W(r,t,e){THREE.BufferGeometry.call(this),this.type="RoundedBoxGeometry",e=isNaN(e)?1:Math.max(1,Math.floor(e));var s,i,a;s=i=a=r,t=r*t,t=Math.min(t,Math.min(s,Math.min(i,Math.min(a)))/2);var h=s/2-t,n=i/2-t,p=a/2-t;this.parameters={width:s,height:i,depth:a,radius:t,radiusSegments:e};var u=e+1,H=u*e+1<<3,R=new THREE.BufferAttribute(new Float32Array(H*3),3),_=new THREE.BufferAttribute(new Float32Array(H*3),3),M=[],v=[];new THREE.Vector3;var z=new THREE.Vector3,x=[],L=[],o=[],O=u*e,m=u*e+1;tt(),st(),et(),it(),ot(),at();function tt(){for(var d=[new THREE.Vector3(1,1,1),new THREE.Vector3(1,1,-1),new THREE.Vector3(-1,1,-1),new THREE.Vector3(-1,1,1),new THREE.Vector3(1,-1,1),new THREE.Vector3(1,-1,-1),new THREE.Vector3(-1,-1,-1),new THREE.Vector3(-1,-1,1)],c=0;c<8;c++)M.push([]),v.push([]);for(var l=Math.PI/2,f=new THREE.Vector3(h,n,p),E=0;E<=e;E++){var k=E/e,A=k*l,g=Math.cos(A),V=Math.sin(A);if(E==e){z.set(0,1,0);var y=z.clone().multiplyScalar(t).add(f);M[0].push(y),x.push(y);var b=z.clone();v[0].push(b),L.push(b);continue}for(var P=0;P<=e;P++){var U=P/e,Z=U*l;z.x=g*Math.cos(Z),z.y=V,z.z=g*Math.sin(Z);var y=z.clone().multiplyScalar(t).add(f);M[0].push(y),x.push(y);var b=z.clone().normalize();v[0].push(b),L.push(b)}}for(var G=1;G<8;G++)for(var c=0;c<M[0].length;c++){var y=M[0][c].clone().multiply(d[G]);M[G].push(y),x.push(y);var b=v[0][c].clone().multiply(d[G]);v[G].push(b),L.push(b)}}function et(){for(var d=[!0,!1,!0,!1,!1,!0,!1,!0],c=u*(e-1),l=0;l<8;l++){for(var f=m*l,E=0;E<e-1;E++)for(var k=E*u,A=(E+1)*u,g=0;g<e;g++){var V=g+1,y=f+k+g,b=f+k+V,P=f+A+g,U=f+A+V;d[l]?(o.push(y),o.push(P),o.push(b),o.push(b),o.push(P),o.push(U)):(o.push(y),o.push(b),o.push(P),o.push(b),o.push(U),o.push(P))}for(var g=0;g<e;g++){var y=f+c+g,b=f+c+g+1,P=f+O;d[l]?(o.push(y),o.push(P),o.push(b)):(o.push(y),o.push(b),o.push(P))}}}function st(){var d=O,c=O+m,l=O+m*2,f=O+m*3;o.push(d),o.push(c),o.push(l),o.push(d),o.push(l),o.push(f),d=O+m*4,c=O+m*5,l=O+m*6,f=O+m*7,o.push(d),o.push(l),o.push(c),o.push(d),o.push(f),o.push(l),d=0,c=m,l=m*4,f=m*5,o.push(d),o.push(l),o.push(c),o.push(c),o.push(l),o.push(f),d=m*2,c=m*3,l=m*6,f=m*7,o.push(d),o.push(l),o.push(c),o.push(c),o.push(l),o.push(f),d=e,c=e+m*3,l=e+m*4,f=e+m*7,o.push(d),o.push(c),o.push(l),o.push(c),o.push(f),o.push(l),d=e+m,c=e+m*2,l=e+m*5,f=e+m*6,o.push(d),o.push(l),o.push(c),o.push(c),o.push(l),o.push(f)}function it(){for(var d=0;d<4;d++)for(var c=d*m,l=4*m+c,f=d&!0,E=0;E<e;E++){var k=E+1,A=c+E,g=c+k,V=l+E,y=l+k;f?(o.push(A),o.push(V),o.push(g),o.push(g),o.push(V),o.push(y)):(o.push(A),o.push(g),o.push(V),o.push(g),o.push(y),o.push(V))}}function at(){for(var d=[0,2,4,6],c=[1,3,5,7],l=0;l<4;l++)for(var f=m*d[l],E=m*c[l],k=1>=l,A=0;A<e;A++){var g=A*u,V=(A+1)*u,y=f+g,b=f+V,P=E+g,U=E+V;k?(o.push(y),o.push(P),o.push(b),o.push(b),o.push(P),o.push(U)):(o.push(y),o.push(b),o.push(P),o.push(b),o.push(U),o.push(P))}}function ot(){for(var d=e-1,c=[0,1,4,5],l=[3,2,7,6],f=[0,1,1,0],E=0;E<4;E++)for(var k=c[E]*m,A=l[E]*m,g=0;g<=d;g++){var V=k+e+g*u,y=k+(g!=d?e+(g+1)*u:m-1),b=A+e+g*u,P=A+(g!=d?e+(g+1)*u:m-1);f[E]?(o.push(V),o.push(b),o.push(y),o.push(y),o.push(b),o.push(P)):(o.push(V),o.push(y),o.push(b),o.push(y),o.push(P),o.push(b))}}for(var J=0,F=0;F<x.length;F++)R.setXYZ(J,x[F].x,x[F].y,x[F].z),_.setXYZ(J,L[F].x,L[F].y,L[F].z),J++;this.setIndex(new THREE.BufferAttribute(new Uint16Array(o),1)),this.addAttribute("position",R),this.addAttribute("normal",_)}W.prototype=Object.create(THREE.BufferGeometry.prototype);W.constructor=W;function nt(r,t,e){var s,i,a,h;s=i=-r/2,a=h=r,t=r*t;const n=new THREE.Shape;return n.moveTo(s,i+t),n.lineTo(s,i+h-t),n.quadraticCurveTo(s,i+h,s+t,i+h),n.lineTo(s+a-t,i+h),n.quadraticCurveTo(s+a,i+h,s+a,i+h-t),n.lineTo(s+a,i+t),n.quadraticCurveTo(s+a,i,s+a-t,i),n.lineTo(s+t,i),n.quadraticCurveTo(s,i,s,i+t),new THREE.ExtrudeBufferGeometry(n,{depth:e,bevelEnabled:!1,curveSegments:3})}class ht{constructor(t){this.game=t,this.size=3,this.geometry={pieceCornerRadius:.12,edgeCornerRoundness:.15,edgeScale:.82,edgeDepth:.01},this.holder=new THREE.Object3D,this.object=new THREE.Object3D,this.animator=new THREE.Object3D,this.holder.add(this.animator),this.animator.add(this.object),this.game.world.scene.add(this.holder)}init(){this.cubes=[],this.object.children=[],this.object.add(this.game.controls.group),this.size===2?this.scale=1.25:this.size===3?this.scale=1:this.size>3&&(this.scale=3/this.size),this.object.scale.set(this.scale,this.scale,this.scale);const t=this.size===2?.825:1;this.game.controls.edges.scale.set(t,t,t),this.generatePositions(),this.generateModel(),this.pieces.forEach(e=>{this.cubes.push(e.userData.cube),this.object.add(e)}),this.holder.traverse(e=>{e.frustumCulled&&(e.frustumCulled=!1)}),this.updateColors(this.game.themes.getColors()),this.sizeGenerated=this.size}resize(t=!1){(this.size!==this.sizeGenerated||t)&&(this.size=this.game.preferences.ranges.size.value,this.reset(),this.init(),this.game.saved=!1,this.game.timer.reset(),this.game.storage.clearGame())}reset(){this.game.controls.edges.rotation.set(0,0,0),this.holder.rotation.set(0,0,0),this.object.rotation.set(0,0,0),this.animator.rotation.set(0,0,0)}generatePositions(){const t=this.size-1,e=this.size%2!==0?0-Math.floor(this.size/2):.5-this.size/2;let s,i,a;for(this.positions=[],s=0;s<this.size;s++)for(i=0;i<this.size;i++)for(a=0;a<this.size;a++){let h=new THREE.Vector3(e+s,e+i,e+a),n=[];s==0&&n.push(0),s==t&&n.push(1),i==0&&n.push(2),i==t&&n.push(3),a==0&&n.push(4),a==t&&n.push(5),h.edges=n,this.positions.push(h)}}generateModel(){this.pieces=[],this.edges=[];const t=1/3,e=new THREE.MeshLambertMaterial,s=new THREE.Mesh(new W(t,this.geometry.pieceCornerRadius,3),e.clone()),i=nt(t,this.geometry.edgeCornerRoundness,this.geometry.edgeDepth);this.positions.forEach((a,h)=>{const n=new THREE.Object3D,p=s.clone(),u=[];n.position.copy(a.clone().divideScalar(3)),n.add(p),n.name=h,n.edgesName="",a.edges.forEach(H=>{const R=new THREE.Mesh(i,e.clone()),_=["L","R","D","U","B","F"][H],M=t/2;R.position.set(M*[-1,1,0,0,0,0][H],M*[0,0,-1,1,0,0][H],M*[0,0,0,0,-1,1][H]),R.rotation.set(Math.PI/2*[0,0,1,-1,0,0][H],Math.PI/2*[-1,1,0,0,2,0][H],0),R.scale.set(this.geometry.edgeScale,this.geometry.edgeScale,this.geometry.edgeScale),R.name=_,n.add(R),u.push(_),this.edges.push(R)}),n.userData.edges=u,n.userData.cube=p,n.userData.start={position:n.position.clone(),rotation:n.rotation.clone()},this.pieces.push(n)})}updateColors(t){typeof this.pieces!="object"&&typeof this.edges!="object"||(this.pieces.forEach(e=>e.userData.cube.material.color.setHex(t.P)),this.edges.forEach(e=>e.material.color.setHex(t[e.name])))}loadFromData(t){this.size=t.size,this.reset(),this.init(),this.pieces.forEach(e=>{const s=t.names.indexOf(e.name),i=t.positions[s],a=t.rotations[s];e.position.set(i.x,i.y,i.z),e.rotation.set(a.x,a.y,a.z)})}}const C={Power:{In:r=>(r=Math.round(r||1),t=>Math.pow(t,r)),Out:r=>(r=Math.round(r||1),t=>1-Math.abs(Math.pow(t-1,r))),InOut:r=>(r=Math.round(r||1),t=>t<.5?Math.pow(t*2,r)/2:(1-Math.abs(Math.pow(t*2-1-1,r)))/2+.5)},Sine:{In:()=>r=>1+Math.sin(Math.PI/2*r-Math.PI/2),Out:()=>r=>Math.sin(Math.PI/2*r),InOut:()=>r=>(1+Math.sin(Math.PI*r-Math.PI/2))/2},Back:{Out:r=>(r=r||1.70158,t=>(t-=1)*t*((r+1)*t+r)+1),In:r=>(r=r||1.70158,t=>t*t*((r+1)*t-r))},Elastic:{Out:(r,t)=>{let e=Math.PI*2,s=r>=1?r:1,i=(t||.3)/(r<1?r:1),a=i/e*(Math.asin(1/s)||0);return i=e/i,h=>s*Math.pow(2,-10*h)*Math.sin((h-a)*i)+1}}};class D extends ${constructor(t){super(!1),this.duration=t.duration||500,this.easing=t.easing||(e=>e),this.onUpdate=t.onUpdate||(()=>{}),this.onComplete=t.onComplete||(()=>{}),this.delay=t.delay||!1,this.yoyo=t.yoyo?!1:null,this.progress=0,this.value=0,this.delta=0,this.getFromTo(t),this.delay?setTimeout(()=>super.start(),this.delay):super.start(),this.onUpdate(this)}update(t){const e=this.value*1,s=this.yoyo===!0?-1:1;this.progress+=t/this.duration*s,this.value=this.easing(this.progress),this.delta=this.value-e,this.values!==null&&this.updateFromTo(),this.yoyo!==null?this.updateYoyo():this.progress<=1?this.onUpdate(this):(this.progress=1,this.value=1,this.onUpdate(this),this.onComplete(this),super.stop())}updateYoyo(){(this.progress>1||this.progress<0)&&(this.value=this.progress=this.progress>1?1:0,this.yoyo=!this.yoyo),this.onUpdate(this)}updateFromTo(){this.values.forEach(t=>{this.target[t]=this.from[t]+(this.to[t]-this.from[t])*this.value})}getFromTo(t){if(!t.target||!t.to){this.values=null;return}this.target=t.target||null,this.from=t.from||{},this.to=t.to||null,this.values=[],Object.keys(this.from).length<1&&Object.keys(this.to).forEach(e=>{this.from[e]=this.target[e]}),Object.keys(this.to).forEach(e=>{this.values.push(e)})}}window.addEventListener("touchmove",()=>{});document.addEventListener("touchmove",r=>{r.preventDefault()},{passive:!1});class Q{constructor(t,e){return this.position={current:new THREE.Vector2,start:new THREE.Vector2,delta:new THREE.Vector2,old:new THREE.Vector2,drag:new THREE.Vector2},this.options=Object.assign({calcDelta:!1},e||{}),this.element=t,this.touch=null,this.drag={start:s=>{s.type=="mousedown"&&s.which!=1||s.type=="touchstart"&&s.touches.length>1||(this.getPositionCurrent(s),this.options.calcDelta&&(this.position.start=this.position.current.clone(),this.position.delta.set(0,0),this.position.drag.set(0,0)),this.touch=s.type=="touchstart",this.onDragStart(this.position),window.addEventListener(this.touch?"touchmove":"mousemove",this.drag.move,!1),window.addEventListener(this.touch?"touchend":"mouseup",this.drag.end,!1))},move:s=>{this.options.calcDelta&&(this.position.old=this.position.current.clone()),this.getPositionCurrent(s),this.options.calcDelta&&(this.position.delta=this.position.current.clone().sub(this.position.old),this.position.drag=this.position.current.clone().sub(this.position.start)),this.onDragMove(this.position)},end:s=>{this.getPositionCurrent(s),this.onDragEnd(this.position),window.removeEventListener(this.touch?"touchmove":"mousemove",this.drag.move,!1),window.removeEventListener(this.touch?"touchend":"mouseup",this.drag.end,!1)}},this.onDragStart=()=>{},this.onDragMove=()=>{},this.onDragEnd=()=>{},this.enable(),this}enable(){return this.element.addEventListener("touchstart",this.drag.start,!1),this.element.addEventListener("mousedown",this.drag.start,!1),this}disable(){return this.element.removeEventListener("touchstart",this.drag.start,!1),this.element.removeEventListener("mousedown",this.drag.start,!1),this}getPositionCurrent(t){const e=t.touches?t.touches[0]||t.changedTouches[0]:t;this.position.current.set(e.pageX,e.pageY)}convertPosition(t){return t.x=t.x/this.element.offsetWidth*2-1,t.y=-(t.y/this.element.offsetHeight*2-1),t}}const j=0,B=1,N=2,Y=3;class lt{constructor(t){this.game=t,this.flipConfig=0,this.flipEasings=[C.Power.Out(3),C.Sine.Out(),C.Back.Out(1.5)],this.flipSpeeds=[125,200,300],this.raycaster=new THREE.Raycaster;const e=new THREE.MeshBasicMaterial({depthWrite:!1,transparent:!0,opacity:0,color:13311});this.group=new THREE.Object3D,this.group.name="controls",this.game.cube.object.add(this.group),this.helper=new THREE.Mesh(new THREE.PlaneBufferGeometry(200,200),e.clone()),this.helper.rotation.set(0,Math.PI/4,0),this.game.world.scene.add(this.helper),this.edges=new THREE.Mesh(new THREE.BoxBufferGeometry(1,1,1),e.clone()),this.game.world.scene.add(this.edges),this.onSolved=()=>{},this.onMove=()=>{},this.momentum=[],this.scramble=null,this.state=j,this.enabled=!1,this.initDraggable()}enable(){this.draggable.enable(),this.enabled=!0}disable(){this.draggable.disable(),this.enabled=!1}initDraggable(){this.draggable=new Q(this.game.dom.game),this.draggable.onDragStart=t=>{if(this.scramble!==null||this.state===B||this.state===N)return;this.gettingDrag=this.state===Y;const e=this.getIntersect(t.current,this.edges,!1);e!==!1&&(this.dragIntersect=this.getIntersect(t.current,this.game.cube.cubes,!0)),e!==!1&&this.dragIntersect!==!1?(this.dragNormal=e.face.normal.round(),this.flipType="layer",this.attach(this.helper,this.edges),this.helper.rotation.set(0,0,0),this.helper.position.set(0,0,0),this.helper.lookAt(this.dragNormal),this.helper.translateZ(.5),this.helper.updateMatrixWorld(),this.detach(this.helper,this.edges)):(this.dragNormal=new THREE.Vector3(0,0,1),this.flipType="cube",this.helper.position.set(0,0,0),this.helper.rotation.set(0,Math.PI/4,0),this.helper.updateMatrixWorld());let s=this.getIntersect(t.current,this.helper,!1);s!==!1&&(this.dragCurrent=this.helper.worldToLocal(s.point),this.dragTotal=new THREE.Vector3,this.state=this.state===j?B:this.state)},this.draggable.onDragMove=t=>{if(this.scramble!==null||this.state===j||this.state===Y&&this.gettingDrag===!1)return;const e=this.getIntersect(t.current,this.helper,!1);if(e===!1)return;const s=this.helper.worldToLocal(e.point.clone());if(this.dragDelta=s.clone().sub(this.dragCurrent).setZ(0),this.dragTotal.add(this.dragDelta),this.dragCurrent=s,this.addMomentumPoint(this.dragDelta),this.state===B&&this.dragTotal.length()>.05){if(this.dragDirection=this.getMainAxis(this.dragTotal),this.flipType==="layer"){const i=new THREE.Vector3;i[this.dragDirection]=1;const a=this.helper.localToWorld(i).sub(this.helper.position),h=this.edges.worldToLocal(a).round();this.flipAxis=h.cross(this.dragNormal).negate(),this.selectLayer(this.getLayer(!1))}else{const i=this.dragDirection!="x"?this.dragDirection=="y"&&t.current.x>this.game.world.width/2?"z":"x":"y";this.flipAxis=new THREE.Vector3,this.flipAxis[i]=1*(i=="x"?-1:1)}this.flipAngle=0,this.state=N}else if(this.state===N){const i=this.dragDelta[this.dragDirection];this.flipType==="layer"?(this.group.rotateOnAxis(this.flipAxis,i),this.flipAngle+=i):(this.edges.rotateOnWorldAxis(this.flipAxis,i),this.game.cube.object.rotation.copy(this.edges.rotation),this.flipAngle+=i)}},this.draggable.onDragEnd=t=>{if(this.scramble!==null)return;if(this.state!==N){this.gettingDrag=!1,this.state=j;return}this.state=Y;const e=this.getMomentum()[this.dragDirection],a=(Math.abs(e)>.05&&Math.abs(this.flipAngle)<Math.PI/2?this.roundAngle(this.flipAngle+Math.sign(this.flipAngle)*(Math.PI/4)):this.roundAngle(this.flipAngle))-this.flipAngle;this.flipType==="layer"?this.rotateLayer(a,!1,h=>{this.game.storage.saveGame(),this.state=this.gettingDrag?B:j,this.gettingDrag=!1,this.checkIsSolved()}):this.rotateCube(a,()=>{this.state=this.gettingDrag?B:j,this.gettingDrag=!1})}}rotateLayer(t,e,s){const i=e?0:this.flipConfig,a=this.flipEasings[i],h=this.flipSpeeds[i],n=i==2?this.bounceCube():()=>{};this.rotationTween=new D({easing:a,duration:h,onUpdate:p=>{let u=p.delta*t;this.group.rotateOnAxis(this.flipAxis,u),n(p.value,u,t)},onComplete:()=>{e||this.onMove();const p=this.flipLayer.slice(0);this.game.cube.object.rotation.setFromVector3(this.snapRotation(this.game.cube.object.rotation.toVector3())),this.group.rotation.setFromVector3(this.snapRotation(this.group.rotation.toVector3())),this.deselectLayer(this.flipLayer),s(p)}})}bounceCube(){let t=!0;return(e,s,i)=>{e>=1&&(t&&(s=(e-1)*i,t=!1),this.game.cube.object.rotateOnAxis(this.flipAxis,s))}}rotateCube(t,e){const s=this.flipConfig,i=[C.Power.Out(4),C.Sine.Out(),C.Back.Out(2)][s],a=[100,150,350][s];this.rotationTween=new D({easing:i,duration:a,onUpdate:h=>{this.edges.rotateOnWorldAxis(this.flipAxis,h.delta*t),this.game.cube.object.rotation.copy(this.edges.rotation)},onComplete:()=>{this.edges.rotation.setFromVector3(this.snapRotation(this.edges.rotation.toVector3())),this.game.cube.object.rotation.copy(this.edges.rotation),e()}})}selectLayer(t){this.group.rotation.set(0,0,0),this.movePieces(t,this.game.cube.object,this.group),this.flipLayer=t}deselectLayer(t){this.movePieces(t,this.group,this.game.cube.object),this.flipLayer=null}movePieces(t,e,s){e.updateMatrixWorld(),s.updateMatrixWorld(),t.forEach(i=>{const a=this.game.cube.pieces[i];a.applyMatrix(e.matrixWorld),e.remove(a),a.applyMatrix(new THREE.Matrix4().getInverse(s.matrixWorld)),s.add(a)})}getLayer(t){const e={2:6,3:3,4:4,5:3}[this.game.cube.size],s=[];let i;if(t===!1){const a=this.dragIntersect.object.parent;i=this.getMainAxis(this.flipAxis),t=a.position.clone().multiplyScalar(e).round()}else i=this.getMainAxis(t);return this.game.cube.pieces.forEach(a=>{a.position.clone().multiplyScalar(e).round()[i]==t[i]&&s.push(a.name)}),s}keyboardMove(t,e,s){if(this.state===j&&this.enabled===!0)if(t==="LAYER"){const i=this.getLayer(e.position);this.flipAxis=new THREE.Vector3,this.flipAxis[e.axis]=1,this.state=N,this.selectLayer(i),this.rotateLayer(e.angle,!1,a=>{this.game.storage.saveGame(),this.state=j,this.checkIsSolved()})}else t==="CUBE"&&(this.flipAxis=new THREE.Vector3,this.flipAxis[e.axis]=1,this.state=N,this.rotateCube(e.angle,()=>{this.state=j}))}scrambleCube(){this.scramble==null&&(this.scramble=this.game.scrambler,this.scramble.callback=typeof callback!="function"?()=>{}:callback);const t=this.scramble.converted,e=t[0],s=this.getLayer(e.position);this.flipAxis=new THREE.Vector3,this.flipAxis[e.axis]=1,this.selectLayer(s),this.rotateLayer(e.angle,!0,()=>{t.shift(),t.length>0?this.scrambleCube():(this.scramble=null,this.game.storage.saveGame())})}getIntersect(t,e,s){this.raycaster.setFromCamera(this.draggable.convertPosition(t.clone()),this.game.world.camera);const i=s?this.raycaster.intersectObjects(e):this.raycaster.intersectObject(e);return i.length>0?i[0]:!1}getMainAxis(t){return Object.keys(t).reduce((e,s)=>Math.abs(t[e])>Math.abs(t[s])?e:s)}detach(t,e){t.applyMatrix(e.matrixWorld),e.remove(t),this.game.world.scene.add(t)}attach(t,e){t.applyMatrix(new THREE.Matrix4().getInverse(e.matrixWorld)),this.game.world.scene.remove(t),e.add(t)}addMomentumPoint(t){const e=Date.now();this.momentum=this.momentum.filter(s=>e-s.time<500),t!==!1&&this.momentum.push({delta:t,time:e})}getMomentum(){const t=this.momentum.length,e=new THREE.Vector2;return this.addMomentumPoint(!1),this.momentum.forEach((s,i)=>{e.add(s.delta.multiplyScalar(i/t))}),e}roundAngle(t){const e=Math.PI/2;return Math.sign(t)*Math.round(Math.abs(t)/e)*e}snapRotation(t){return t.set(this.roundAngle(t.x),this.roundAngle(t.y),this.roundAngle(t.z))}checkIsSolved(){performance.now();let t=!0;const e={"x-":[],"x+":[],"y-":[],"y+":[],"z-":[],"z+":[]};this.game.cube.edges.forEach(s=>{const i=s.parent.localToWorld(s.position.clone()).sub(this.game.cube.object.position),a=this.getMainAxis(i),h=i.multiplyScalar(2).round()[a]<1?"-":"+";e[a+h].push(s.name)}),Object.keys(e).forEach(s=>{e[s].every(i=>i===e[s][0])||(t=!1)}),t&&this.onSolved()}}class ct{constructor(t){this.game=t,this.dificulty=0,this.scrambleLength={2:[7,9,11],3:[20,25,30],4:[30,40,50],5:[40,60,80]},this.moves=[],this.conveted=[],this.pring=""}scramble(t){let e=0;if(this.moves=typeof t<"u"?t.split(" "):[],this.moves.length<1){const s=this.scrambleLength[this.game.cube.size][this.dificulty],i=this.game.cube.size<4?"UDLRFB":"UuDdLlRrFfBb",a=["","'","2"],h=typeof t>"u"?s:t;for(;e<h;){const n=i[Math.floor(Math.random()*i.length)]+a[Math.floor(Math.random()*3)];e>0&&n.charAt(0)==this.moves[e-1].charAt(0)||e>1&&n.charAt(0)==this.moves[e-2].charAt(0)||(this.moves.push(n),e++)}}return this.callback=()=>{},this.convert(),this.print=this.moves.join(" "),this}convert(t){this.converted=[],this.moves.forEach(e=>{const s=this.convertMove(e),i=e.charAt(1);this.converted.push(s),i=="2"&&this.converted.push(s)})}convertMove(t){const e=t.charAt(0),s=t.charAt(1),i={D:"y",U:"y",L:"x",R:"x",F:"z",B:"z"}[e.toUpperCase()];let a={D:-1,U:1,L:-1,R:1,F:1,B:-1}[e.toUpperCase()];this.game.cube.size>3&&e!==e.toLowerCase()&&(a=a*2);const h=new THREE.Vector3;h[{D:"y",U:"y",L:"x",R:"x",F:"z",B:"z"}[e.toUpperCase()]]=a;const n=Math.PI/2*-a*(s=="'"?-1:1);return{position:h,axis:i,angle:n,name:t}}}class ut{constructor(t){this.game=t,this.tweens={},this.durations={},this.data={cubeY:-.2,cameraZoom:.85},this.activeTransitions=0}init(){this.game.controls.disable(),this.game.cube.object.position.y=this.data.cubeY,this.game.cube.animator.position.y=4,this.game.cube.animator.rotation.x=-Math.PI/3,this.game.world.camera.zoom=this.data.cameraZoom,this.game.world.camera.updateProjectionMatrix(),this.tweens.buttons={},this.tweens.timer=[],this.tweens.title=[],this.tweens.best=[],this.tweens.complete=[],this.tweens.prefs=[],this.tweens.theme=[],this.tweens.stats=[]}buttons(t,e){const s=(i,a)=>new D({target:i.style,duration:300,easing:a?C.Power.Out(2):C.Power.In(3),from:{opacity:a?0:1},to:{opacity:a?1:0},onUpdate:h=>{const n=a?1-h.value:h.value;i.style.transform=`translate3d(0, ${n*1.5}em, 0)`},onComplete:()=>i.style.pointerEvents=a?"all":"none"});e.forEach(i=>this.tweens.buttons[i]=s(this.game.dom.buttons[i],!1)),setTimeout(()=>t.forEach(i=>{this.tweens.buttons[i]=s(this.game.dom.buttons[i],!0)}),e?500:0)}cube(t,e=!1){this.activeTransitions++;try{this.tweens.cube.stop()}catch{}const s=this.game.cube.animator.position.y,i=this.game.cube.animator.rotation.x;this.tweens.cube=new D({duration:t?3e3:1250,easing:t?C.Elastic.Out(.8,.6):C.Back.In(1),onUpdate:a=>{this.game.cube.animator.position.y=t?e?.9+(1-a.value)*3.5:(1-a.value)*4:s+a.value*4,this.game.cube.animator.rotation.x=t?(1-a.value)*Math.PI/3:i+a.value*-Math.PI/3}}),e&&(t?(this.game.world.camera.zoom=.75,this.game.world.camera.updateProjectionMatrix()):setTimeout(()=>{this.game.world.camera.zoom=this.data.cameraZoom,this.game.world.camera.updateProjectionMatrix()},1500)),this.durations.cube=1500,setTimeout(()=>this.activeTransitions--,this.durations.cube)}float(){try{this.tweens.float.stop()}catch{}this.tweens.float=new D({duration:1500,easing:C.Sine.InOut(),yoyo:!0,onUpdate:t=>{this.game.cube.holder.position.y=-.02+t.value*.04,this.game.cube.holder.rotation.x=.005-t.value*.01,this.game.cube.holder.rotation.z=-this.game.cube.holder.rotation.x,this.game.cube.holder.rotation.y=this.game.cube.holder.rotation.x,this.game.controls.edges.position.y=this.game.cube.holder.position.y+this.game.cube.object.position.y}})}zoom(t,e){this.activeTransitions++;const s=t?1:this.data.cameraZoom,i=e>0?Math.max(e,1500):1500,a=e>0?Math.round(i/1500):1,h=C.Power.InOut(e>0?2:3);this.tweens.zoom=new D({target:this.game.world.camera,duration:i,easing:h,to:{zoom:s},onUpdate:()=>{this.game.world.camera.updateProjectionMatrix()}}),this.tweens.rotate=new D({target:this.game.cube.animator.rotation,duration:i,easing:h,to:{y:-Math.PI*2*a},onComplete:()=>{this.game.cube.animator.rotation.y=0}}),this.durations.zoom=i,setTimeout(()=>this.activeTransitions--,this.durations.zoom)}elevate(t){this.activeTransitions++,this.tweens.elevate=new D({target:this.game.cube.object.position,duration:t?1500:0,easing:C.Power.InOut(3),to:{y:t?-.05:this.data.cubeY}}),this.durations.elevate=1500,setTimeout(()=>this.activeTransitions--,this.durations.elevate)}complete(t,e){this.activeTransitions++;const s=e?this.game.dom.texts.best:this.game.dom.texts.complete;s.querySelector("span i")===null&&s.querySelectorAll("span").forEach(h=>this.splitLetters(h));const i=s.querySelectorAll(".icon, i");this.flipLetters(e?"best":"complete",i,t),s.style.opacity=1;const a=this.durations[e?"best":"complete"];t||setTimeout(()=>this.game.dom.texts.timer.style.transform="",a),setTimeout(()=>this.activeTransitions--,a)}stats(t){t&&this.game.scores.calcStats(),this.activeTransitions++,this.tweens.stats.forEach(a=>{a.stop(),a=null});let e=-1;const s=this.game.dom.stats.querySelectorAll(".stats"),i=t?C.Power.Out(2):C.Power.In(3);s.forEach((a,h)=>{const n=h*(t?80:60);this.tweens.stats[e++]=new D({delay:n,duration:400,easing:i,onUpdate:p=>{const u=t?(1-p.value)*2:p.value,H=t?p.value:1-p.value;a.style.transform=`translate3d(0, ${u}em, 0)`,a.style.opacity=H}})}),this.durations.stats=0,setTimeout(()=>this.activeTransitions--,this.durations.stats)}preferences(t){this.ranges(this.game.dom.prefs.querySelectorAll(".range"),"prefs",t)}theming(t){this.ranges(this.game.dom.theme.querySelectorAll(".range"),"prefs",t)}ranges(t,e,s){this.activeTransitions++,this.tweens[e].forEach(n=>{n.stop(),n=null});const i=s?C.Power.Out(2):C.Power.In(3);let a=-1,h=0;t.forEach((n,p)=>{const u=n.querySelector(".range__label"),H=n.querySelector(".range__track-line"),R=n.querySelector(".range__handle"),_=n.querySelectorAll(".range__list div"),M=p*(s?120:100);u.style.opacity=s?0:1,H.style.opacity=s?0:1,R.style.opacity=s?0:1,R.style.pointerEvents=s?"all":"none",this.tweens[e][a++]=new D({delay:M,duration:400,easing:i,onUpdate:v=>{const z=s?1-v.value:v.value,x=s?v.value:1-v.value;u.style.transform=`translate3d(0, ${z}em, 0)`,u.style.opacity=x}}),this.tweens[e][a++]=new D({delay:s?M+100:M,duration:400,easing:i,onUpdate:v=>{const z=s?1-v.value:v.value,x=s?v.value:1-v.value,L=x;H.style.transform=`translate3d(0, ${z}em, 0) scale3d(${x}, 1, 1)`,H.style.opacity=L}}),this.tweens[e][a++]=new D({delay:s?M+100:M,duration:400,easing:i,onUpdate:v=>{const z=s?1-v.value:v.value,x=1-z,L=.5+x*.5;R.style.transform=`translate3d(0, ${z}em, 0) scale3d(${L}, ${L}, ${L})`,R.style.opacity=x}}),_.forEach((v,z)=>{v.style.opacity=s?0:1,this.tweens[e][a++]=new D({delay:s?M+200+z*50:M,duration:400,easing:i,onUpdate:x=>{const L=s?1-x.value:x.value,o=s?x.value:1-x.value;v.style.transform=`translate3d(0, ${L}em, 0)`,v.style.opacity=o}})}),h=_.length>h?_.length-1:h,n.style.opacity=1}),this.durations[e]=s?(t.length-1)*100+200+h*50+400:(t.length-1)*100+400,setTimeout(()=>this.activeTransitions--,this.durations[e])}title(t){this.activeTransitions++;const e=this.game.dom.texts.title;e.querySelector("span i")===null&&e.querySelectorAll("span").forEach(a=>this.splitLetters(a));const s=e.querySelectorAll("i");this.flipLetters("title",s,t),e.style.opacity=1;const i=this.game.dom.texts.note;this.tweens.title[s.length]=new D({target:i.style,easing:C.Sine.InOut(),duration:t?800:400,yoyo:t?!0:null,from:{opacity:t?0:parseFloat(getComputedStyle(i).opacity)},to:{opacity:t?1:0}}),setTimeout(()=>this.activeTransitions--,this.durations.title)}timer(t){this.activeTransitions++;const e=this.game.dom.texts.timer;e.style.opacity=0,this.game.timer.convert(),this.game.timer.setText(),this.splitLetters(e);const s=e.querySelectorAll("i");this.flipLetters("timer",s,t),e.style.opacity=1,setTimeout(()=>this.activeTransitions--,this.durations.timer)}splitLetters(t){const e=t.innerHTML;t.innerHTML="",e.split("").forEach(s=>{const i=document.createElement("i");i.innerHTML=s,t.appendChild(i)})}flipLetters(t,e,s){try{this.tweens[t].forEach(i=>i.stop())}catch{}e.forEach((i,a)=>{i.style.opacity=s?0:1,this.tweens[t][a]=new D({easing:C.Sine.Out(),duration:s?800:400,delay:a*50,onUpdate:h=>{const n=s?(1-h.value)*-80:h.value*80;i.style.transform=`rotate3d(0, 1, 0, ${n}deg)`,i.style.opacity=s?h.value:1-h.value}})}),this.durations[t]=(e.length-1)*50+(s?800:400)}}class mt extends ${constructor(t){super(!1),this.game=t,this.reset()}start(t){this.startTime=t?Date.now()-this.deltaTime:Date.now(),this.deltaTime=0,this.converted=this.convert(),super.start()}reset(){this.startTime=0,this.currentTime=0,this.deltaTime=0,this.converted="0:00"}stop(){return this.currentTime=Date.now(),this.deltaTime=this.currentTime-this.startTime,this.convert(),super.stop(),{time:this.converted,millis:this.deltaTime}}update(){const t=this.converted;this.currentTime=Date.now(),this.deltaTime=this.currentTime-this.startTime,this.convert(),this.converted!=t&&(localStorage.setItem("theCube_time",this.deltaTime),this.setText())}convert(){const t=parseInt(this.deltaTime/1e3%60),e=parseInt(this.deltaTime/(1e3*60));this.converted=e+":"+(t<10?"0":"")+t}setText(){this.game.dom.texts.timer.innerHTML=this.converted}}const dt=['<div class="range">','<div class="range__label"></div>','<div class="range__track">','<div class="range__track-line"></div>','<div class="range__handle"><div></div></div>',"</div>",'<div class="range__list"></div>',"</div>"].join(`
`);document.querySelectorAll("range").forEach(r=>{const t=document.createElement("div");t.innerHTML=dt;const e=t.querySelector(".range"),s=e.querySelector(".range__label"),i=e.querySelector(".range__list");e.setAttribute("name",r.getAttribute("name")),s.innerHTML=r.getAttribute("title"),r.hasAttribute("color")&&(e.classList.add("range--type-color"),e.classList.add("range--color-"+r.getAttribute("name"))),r.hasAttribute("list")&&r.getAttribute("list").split(",").forEach(a=>{const h=document.createElement("div");h.innerHTML=a,i.appendChild(h)}),r.parentNode.replaceChild(e,r)});class q{constructor(t,e){e=Object.assign({range:[0,1],value:0,step:0,onUpdate:()=>{},onComplete:()=>{}},e||{}),this.element=document.querySelector('.range[name="'+t+'"]'),this.track=this.element.querySelector(".range__track"),this.handle=this.element.querySelector(".range__handle"),this.list=[].slice.call(this.element.querySelectorAll(".range__list div")),this.value=e.value,this.min=e.range[0],this.max=e.range[1],this.step=e.step,this.onUpdate=e.onUpdate,this.onComplete=e.onComplete,this.setValue(this.value),this.initDraggable()}setValue(t){this.value=this.round(this.limitValue(t)),this.setHandlePosition()}initDraggable(){let t;this.draggable=new Q(this.handle,{calcDelta:!0}),this.draggable.onDragStart=e=>{t=this.positionFromValue(this.value),this.handle.style.left=t+"px"},this.draggable.onDragMove=e=>{t=this.limitPosition(t+e.delta.x),this.value=this.round(this.valueFromPosition(t)),this.setHandlePosition(),this.onUpdate(this.value)},this.draggable.onDragEnd=e=>{this.onComplete(this.value)}}round(t){return this.step<1?t:Math.round((t-this.min)/this.step)*this.step+this.min}limitValue(t){const e=Math.max(this.max,this.min),s=Math.min(this.max,this.min);return Math.min(Math.max(t,s),e)}limitPosition(t){return Math.min(Math.max(t,0),this.track.offsetWidth)}percentsFromValue(t){return(t-this.min)/(this.max-this.min)}valueFromPosition(t){return this.min+(this.max-this.min)*(t/this.track.offsetWidth)}positionFromValue(t){return this.percentsFromValue(t)*this.track.offsetWidth}setHandlePosition(){this.handle.style.left=this.percentsFromValue(this.value)*100+"%"}}class gt{constructor(t){this.game=t}init(){this.ranges={size:new q("size",{value:this.game.cube.size,range:[2,5],step:1,onUpdate:t=>{this.game.cube.size=t,this.game.preferences.ranges.scramble.list.forEach((e,s)=>{e.innerHTML=this.game.scrambler.scrambleLength[this.game.cube.size][s]})},onComplete:()=>this.game.storage.savePreferences()}),flip:new q("flip",{value:this.game.controls.flipConfig,range:[0,2],step:1,onUpdate:t=>{this.game.controls.flipConfig=t},onComplete:()=>this.game.storage.savePreferences()}),scramble:new q("scramble",{value:this.game.scrambler.dificulty,range:[0,2],step:1,onUpdate:t=>{this.game.scrambler.dificulty=t},onComplete:()=>this.game.storage.savePreferences()}),fov:new q("fov",{value:this.game.world.fov,range:[2,45],onUpdate:t=>{this.game.world.fov=t,this.game.world.resize()},onComplete:()=>this.game.storage.savePreferences()}),theme:new q("theme",{value:{cube:0,erno:1,dust:2,camo:3,rain:4}[this.game.themes.theme],range:[0,4],step:1,onUpdate:t=>{const e=["cube","erno","dust","camo","rain"][t];this.game.themes.setTheme(e)},onComplete:()=>this.game.storage.savePreferences()}),hue:new q("hue",{value:0,range:[0,360],onUpdate:t=>this.game.themeEditor.updateHSL(),onComplete:()=>this.game.storage.savePreferences()}),saturation:new q("saturation",{value:100,range:[0,100],onUpdate:t=>this.game.themeEditor.updateHSL(),onComplete:()=>this.game.storage.savePreferences()}),lightness:new q("lightness",{value:50,range:[0,100],onUpdate:t=>this.game.themeEditor.updateHSL(),onComplete:()=>this.game.storage.savePreferences()})},this.ranges.scramble.list.forEach((t,e)=>{t.innerHTML=this.game.scrambler.scrambleLength[this.game.cube.size][e]})}}class pt{constructor(t){this.game=t,this.started=0,this.options={speed:{min:.0011,max:.0022},revolution:{min:.01,max:.05},size:{min:.1,max:.15},colors:[4303560,8571448,16772936,15677731,16747530]},this.geometry=new THREE.PlaneGeometry(1,1),this.material=new THREE.MeshLambertMaterial({side:THREE.DoubleSide}),this.holders=[new K(this.game,this,1,20),new K(this.game,this,-1,30)]}start(){this.started>0||this.holders.forEach(t=>{this.game.world.scene.add(t.holder),t.start(),this.started++})}stop(){this.started!=0&&this.holders.forEach(t=>{t.stop(()=>{this.game.world.scene.remove(t.holder),this.started--})})}updateColors(t){this.holders.forEach(e=>{e.options.colors.forEach((s,i)=>{e.options.colors[i]=t[["D","F","R","B","L"][i]]})})}}class K extends ${constructor(t,e,s,i){super(!1),this.game=t,this.parent=e,this.distanceFromCube=s,this.count=i,this.particles=[],this.holder=new THREE.Object3D,this.holder.rotation.copy(this.game.world.camera.rotation),this.object=new THREE.Object3D,this.holder.add(this.object),this.resizeViewport=this.resizeViewport.bind(this),this.game.world.onResize.push(this.resizeViewport),this.resizeViewport(),this.geometry=this.parent.geometry,this.material=this.parent.material,this.options=this.parent.options;let a=this.count;for(;a--;)this.particles.push(new ft(this))}start(){this.time=performance.now(),this.playing=!0;let t=this.count;for(;t--;)this.particles[t].reset();super.start()}stop(t){this.playing=!1,this.completed=0,this.callback=t}reset(){super.stop(),this.callback()}update(){const t=performance.now(),e=t-this.time;this.time=t;let s=this.count;for(;s--;)this.particles[s].completed||this.particles[s].update(e);!this.playing&&this.completed==this.count&&this.reset()}resizeViewport(){const t=this.game.world.camera.fov*THREE.Math.DEG2RAD;this.height=2*Math.tan(t/2)*(this.game.world.camera.position.length()-this.distanceFromCube),this.width=this.height*this.game.world.camera.aspect;const e=1/this.game.transition.data.cameraZoom;this.width*=e,this.height*=e,this.object.position.z=this.distanceFromCube,this.object.position.y=this.height/2}}class ft{constructor(t){return this.confetti=t,this.options=this.confetti.options,this.velocity=new THREE.Vector3,this.force=new THREE.Vector3,this.mesh=new THREE.Mesh(this.confetti.geometry,this.confetti.material.clone()),this.confetti.object.add(this.mesh),this.size=THREE.Math.randFloat(this.options.size.min,this.options.size.max),this.mesh.scale.set(this.size,this.size,this.size),this}reset(t=!0){this.completed=!1,this.color=new THREE.Color(this.options.colors[Math.floor(Math.random()*this.options.colors.length)]),this.mesh.material.color.set(this.color),this.speed=THREE.Math.randFloat(this.options.speed.min,this.options.speed.max)*-1,this.mesh.position.x=THREE.Math.randFloat(-this.confetti.width/2,this.confetti.width/2),this.mesh.position.y=t?THREE.Math.randFloat(this.size,this.confetti.height+this.size):this.size,this.revolutionSpeed=THREE.Math.randFloat(this.options.revolution.min,this.options.revolution.max),this.revolutionAxis=["x","y","z"][Math.floor(Math.random()*3)],this.mesh.rotation.set(Math.random()*Math.PI/3,Math.random()*Math.PI/3,Math.random()*Math.PI/3)}stop(){this.completed=!0,this.confetti.completed++}update(t){this.mesh.position.y+=this.speed*t,this.mesh.rotation[this.revolutionAxis]+=this.revolutionSpeed,this.mesh.position.y<-this.confetti.height-this.size&&(this.confetti.playing?this.reset(!1):this.stop())}}class vt{constructor(t){this.game=t,this.data={2:{scores:[],solves:0,best:0,worst:0},3:{scores:[],solves:0,best:0,worst:0},4:{scores:[],solves:0,best:0,worst:0},5:{scores:[],solves:0,best:0,worst:0}}}addScore(t){const e=this.data[this.game.cube.sizeGenerated];e.scores.push(t),e.solves++,e.scores.lenght>100&&e.scores.shift();let s=!1;return(t<e.best||e.best===0)&&(e.best=t,s=!0),t>e.worst&&(e.worst=t),this.game.storage.saveScores(),s}calcStats(){const t=this.game.cube.sizeGenerated,e=this.data[t];this.setStat("cube-size",`${t}<i>x</i>${t}<i>x</i>${t}`),this.setStat("total-solves",e.solves),this.setStat("best-time",this.convertTime(e.best)),this.setStat("worst-time",this.convertTime(e.worst)),this.setStat("average-5",this.getAverage(5)),this.setStat("average-12",this.getAverage(12)),this.setStat("average-25",this.getAverage(25))}setStat(t,e){e===0&&(e="-"),this.game.dom.stats.querySelector(`.stats[name="${t}"] b`).innerHTML=e}getAverage(t){const e=this.data[this.game.cube.sizeGenerated];return e.scores.length<t?0:this.convertTime(e.scores.slice(-t).reduce((s,i)=>s+i,0)/t)}convertTime(t){if(t<=0)return 0;const e=parseInt(t/1e3%60);return parseInt(t/(1e3*60))+":"+(e<10?"0":"")+e}}class bt{constructor(t){this.game=t;const e=localStorage.getItem("theCube_version");(!e||e!==window.gameVersion)&&(this.clearGame(),this.clearPreferences(),this.migrateScores(),localStorage.setItem("theCube_version",window.gameVersion))}init(){this.loadPreferences(),this.loadScores()}loadGame(){try{if(!(localStorage.getItem("theCube_playing")==="true"))throw new Error;const e=JSON.parse(localStorage.getItem("theCube_savedState")),s=parseInt(localStorage.getItem("theCube_time"));if(!e||s===null)throw new Error;if(e.size!==this.game.cube.sizeGenerated)throw new Error;this.game.cube.loadFromData(e),this.game.timer.deltaTime=s,this.game.saved=!0}catch{this.game.saved=!1}}saveGame(){const e={names:[],positions:[],rotations:[]},s=this.game.timer.deltaTime;e.size=this.game.cube.sizeGenerated,this.game.cube.pieces.forEach(i=>{e.names.push(i.name),e.positions.push(i.position),e.rotations.push(i.rotation.toVector3())}),localStorage.setItem("theCube_playing",!0),localStorage.setItem("theCube_savedState",JSON.stringify(e)),localStorage.setItem("theCube_time",s)}clearGame(){localStorage.removeItem("theCube_playing"),localStorage.removeItem("theCube_savedState"),localStorage.removeItem("theCube_time")}loadScores(){try{const t=JSON.parse(localStorage.getItem("theCube_scores"));if(!t)throw new Error;this.game.scores.data=t}catch{}}saveScores(){const t=this.game.scores.data;localStorage.setItem("theCube_scores",JSON.stringify(t))}clearScores(){localStorage.removeItem("theCube_scores")}migrateScores(){try{const t=JSON.parse(localStorage.getItem("theCube_scoresData")),e=parseInt(localStorage.getItem("theCube_scoresBest")),s=parseInt(localStorage.getItem("theCube_scoresWorst")),i=parseInt(localStorage.getItem("theCube_scoresSolves"));if(!t||!e||!i||!s)return!1;this.game.scores.data[3].scores=t,this.game.scores.data[3].best=e,this.game.scores.data[3].solves=i,this.game.scores.data[3].worst=s,localStorage.removeItem("theCube_scoresData"),localStorage.removeItem("theCube_scoresBest"),localStorage.removeItem("theCube_scoresWorst"),localStorage.removeItem("theCube_scoresSolves")}catch{}}loadPreferences(){try{const t=JSON.parse(localStorage.getItem("theCube_preferences"));if(!t)throw new Error;return this.game.cube.size=parseInt(t.cubeSize),this.game.controls.flipConfig=parseInt(t.flipConfig),this.game.scrambler.dificulty=parseInt(t.dificulty),this.game.world.fov=parseFloat(t.fov),this.game.world.resize(),this.game.themes.colors=t.colors,this.game.themes.setTheme(t.theme),!0}catch{return this.game.cube.size=3,this.game.controls.flipConfig=0,this.game.scrambler.dificulty=1,this.game.world.fov=10,this.game.world.resize(),this.game.themes.setTheme("cube"),this.savePreferences(),!1}}savePreferences(){const t={cubeSize:this.game.cube.size,flipConfig:this.game.controls.flipConfig,dificulty:this.game.scrambler.dificulty,fov:this.game.world.fov,theme:this.game.themes.theme,colors:this.game.themes.colors};localStorage.setItem("theCube_preferences",JSON.stringify(t))}clearPreferences(){localStorage.removeItem("theCube_preferences")}}class yt{constructor(t){this.game=t,this.theme=null,this.defaults={cube:{U:16775167,D:16772936,F:15677731,R:4303560,B:16747530,L:8571448,P:528410,G:13751771},erno:{U:16777215,D:16766208,F:12852794,R:20922,B:16734208,L:40544,P:528410,G:9092607},dust:{U:16774891,D:15189133,F:9381182,R:6323817,B:12480354,L:8691549,P:528410,G:15189133},camo:{U:16774891,D:12564082,F:3613724,R:7439446,B:8411185,L:3621661,P:528410,G:12564082},rain:{U:16448255,D:15579437,F:13508917,R:4496009,B:15489071,L:10725703,P:528410,G:8894892}},this.colors=JSON.parse(JSON.stringify(this.defaults))}getColors(){return this.colors[this.theme]}setTheme(t=!1,e=!1){if(t===this.theme&&e===!1)return;t!==!1&&(this.theme=t);const s=this.getColors();this.game.dom.prefs.querySelectorAll(".range__handle div").forEach(i=>{i.style.background="#"+s.R.toString(16).padStart(6,"0")}),this.game.cube.updateColors(s),this.game.confetti.updateColors(s),this.game.dom.back.style.background="#"+s.G.toString(16).padStart(6,"0")}}class xt{constructor(t){this.game=t,this.editColor="R",this.getPieceColor=this.getPieceColor.bind(this)}colorFromHSL(t,e,s){return t=Math.round(t),e=Math.round(e),s=Math.round(s),new THREE.Color(`hsl(${t}, ${e}%, ${s}%)`)}setHSL(t=null,e=!1){this.editColor=t===null?"R":t;const s=new THREE.Color(this.game.themes.getColors()[this.editColor]),{h:i,s:a,l:h}=s.getHSL(s),{hue:n,saturation:p,lightness:u}=this.game.preferences.ranges;if(e){const H=n.value/360,R=p.value/100,_=u.value/100,M=this.colorFromHSL(n.value,p.value,u.value);this.tweenHSL&&this.tweenHSL.stop(),this.tweenHSL=new D({duration:200,easing:C.Sine.Out(),onUpdate:v=>{n.setValue((H+(i-H)*v.value)*360),p.setValue((R+(a-R)*v.value)*100),u.setValue((_+(h-_)*v.value)*100);const z=M.clone().lerp(s,v.value),x=z.getStyle(),L=z.getHSL(z);n.handle.style.color=x,p.handle.style.color=x,u.handle.style.color=x,p.track.style.color=this.colorFromHSL(L.h*360,100,50).getStyle(),u.track.style.color=this.colorFromHSL(L.h*360,L.s*100,50).getStyle(),this.game.dom.theme.style.display="none",this.game.dom.theme.offsetHeight,this.game.dom.theme.style.display=""},onComplete:()=>{this.updateHSL(),this.game.storage.savePreferences()}})}else n.setValue(i*360),p.setValue(a*100),u.setValue(h*100),this.updateHSL(),this.game.storage.savePreferences()}updateHSL(){const{hue:t,saturation:e,lightness:s}=this.game.preferences.ranges,i=t.value,a=e.value,h=s.value,n=this.colorFromHSL(i,a,h).getStyle();t.handle.style.color=n,e.handle.style.color=n,s.handle.style.color=n,e.track.style.color=this.colorFromHSL(i,100,50).getStyle(),s.track.style.color=this.colorFromHSL(i,a,50).getStyle(),this.game.dom.theme.style.display="none",this.game.dom.theme.offsetHeight,this.game.dom.theme.style.display="";const p=this.game.themes.theme;this.game.themes.colors[p][this.editColor]=this.colorFromHSL(i,a,h).getHex(),this.game.themes.setTheme()}colorPicker(t){t?this.game.dom.game.addEventListener("click",this.getPieceColor,!1):this.game.dom.game.removeEventListener("click",this.getPieceColor,!1)}getPieceColor(t){const e=t.touches?t.touches[0]||t.changedTouches[0]:t,s=new THREE.Vector2(e.pageX,e.pageY);let i=this.game.controls.getIntersect(s,this.game.cube.edges,!0),a=this.game.controls.getIntersect(s,this.game.cube.cubes,!0);if(i!==!1){const n=i.object,p=n.parent.localToWorld(n.position.clone()).sub(this.game.cube.object.position).sub(this.game.cube.animator.position),u=this.game.controls.getMainAxis(p);p.multiplyScalar(2).round()[u]<1&&(i=!1)}const h=i?i.object.name:a?"P":"G";this.setHSL(h,!0)}resetTheme(){this.game.themes.colors[this.game.themes.theme]=JSON.parse(JSON.stringify(this.game.themes.defaults[this.game.themes.theme])),this.game.themes.setTheme(),this.setHSL(this.editColor,!0)}}const Et={3:{checkerboard:{names:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26],positions:[{x:1/3,y:-1/3,z:1/3},{x:-1/3,y:1/3,z:0},{x:1/3,y:-1/3,z:-1/3},{x:-1/3,y:0,z:-1/3},{x:1/3,y:0,z:0},{x:-1/3,y:0,z:1/3},{x:1/3,y:1/3,z:1/3},{x:-1/3,y:-1/3,z:0},{x:1/3,y:1/3,z:-1/3},{x:0,y:1/3,z:-1/3},{x:0,y:-1/3,z:0},{x:0,y:1/3,z:1/3},{x:0,y:0,z:1/3},{x:0,y:0,z:0},{x:0,y:0,z:-1/3},{x:0,y:-1/3,z:-1/3},{x:0,y:1/3,z:0},{x:0,y:-1/3,z:1/3},{x:-1/3,y:-1/3,z:1/3},{x:1/3,y:1/3,z:0},{x:-1/3,y:-1/3,z:-1/3},{x:1/3,y:0,z:-1/3},{x:-1/3,y:0,z:0},{x:1/3,y:0,z:1/3},{x:-1/3,y:1/3,z:1/3},{x:1/3,y:-1/3,z:0},{x:-1/3,y:1/3,z:-1/3}],rotations:[{x:-Math.PI,y:0,z:Math.PI},{x:Math.PI,y:0,z:0},{x:-Math.PI,y:0,z:Math.PI},{x:0,y:0,z:0},{x:0,y:0,z:Math.PI},{x:0,y:0,z:0},{x:-Math.PI,y:0,z:Math.PI},{x:Math.PI,y:0,z:0},{x:-Math.PI,y:0,z:Math.PI},{x:0,y:0,z:Math.PI},{x:0,y:0,z:0},{x:0,y:0,z:Math.PI},{x:-Math.PI,y:0,z:0},{x:Math.PI,y:0,z:Math.PI},{x:Math.PI,y:0,z:0},{x:0,y:0,z:Math.PI},{x:0,y:0,z:0},{x:0,y:0,z:Math.PI},{x:Math.PI,y:0,z:Math.PI},{x:-Math.PI,y:0,z:0},{x:Math.PI,y:0,z:Math.PI},{x:0,y:0,z:0},{x:0,y:0,z:Math.PI},{x:0,y:0,z:0},{x:Math.PI,y:0,z:Math.PI},{x:-Math.PI,y:0,z:0},{x:Math.PI,y:0,z:Math.PI}],size:3}}};class Tt{constructor(t){if(t=Object.assign({tagName:"icon",className:"icon",styles:!1,icons:{},observe:!1,convert:!1},t||{}),this.tagName=t.tagName,this.className=t.className,this.icons=t.icons,this.svgTag=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svgTag.setAttribute("class",this.className),t.styles&&this.addStyles(),t.convert&&this.convertAllIcons(),t.observe){const e=window.MutationObserver||window.WebKitMutationObserver;this.observer=new e(s=>{this.convertAllIcons()}),this.observer.observe(document.documentElement,{childList:!0,subtree:!0})}return this}convertAllIcons(){document.querySelectorAll(this.tagName).forEach(t=>{this.convertIcon(t)})}convertIcon(t){const e=this.icons[t.attributes[0].localName];if(typeof e>"u")return;const s=this.svgTag.cloneNode(!0),i=e.viewbox.split(" ");s.setAttributeNS(null,"viewBox",e.viewbox),s.style.width=i[2]/i[3]+"em",s.style.height="1em",s.innerHTML=e.content,t.parentNode.replaceChild(s,t)}addStyles(){const t=document.createElement("style");t.innerHTML=`.${this.className} { display: inline-block; font-size: inherit; overflow: visible; vertical-align: -0.125em; preserveAspectRatio: none; }`,document.head.appendChild(t)}}new Tt({icons:{settings:{viewbox:"0 0 512 512",content:'<path fill="currentColor" d="M444.788 291.1l42.616 24.599c4.867 2.809 7.126 8.618 5.459 13.985-11.07 35.642-29.97 67.842-54.689 94.586a12.016 12.016 0 0 1-14.832 2.254l-42.584-24.595a191.577 191.577 0 0 1-60.759 35.13v49.182a12.01 12.01 0 0 1-9.377 11.718c-34.956 7.85-72.499 8.256-109.219.007-5.49-1.233-9.403-6.096-9.403-11.723v-49.184a191.555 191.555 0 0 1-60.759-35.13l-42.584 24.595a12.016 12.016 0 0 1-14.832-2.254c-24.718-26.744-43.619-58.944-54.689-94.586-1.667-5.366.592-11.175 5.459-13.985L67.212 291.1a193.48 193.48 0 0 1 0-70.199l-42.616-24.599c-4.867-2.809-7.126-8.618-5.459-13.985 11.07-35.642 29.97-67.842 54.689-94.586a12.016 12.016 0 0 1 14.832-2.254l42.584 24.595a191.577 191.577 0 0 1 60.759-35.13V25.759a12.01 12.01 0 0 1 9.377-11.718c34.956-7.85 72.499-8.256 109.219-.007 5.49 1.233 9.403 6.096 9.403 11.723v49.184a191.555 191.555 0 0 1 60.759 35.13l42.584-24.595a12.016 12.016 0 0 1 14.832 2.254c24.718 26.744 43.619 58.944 54.689 94.586 1.667 5.366-.592 11.175-5.459 13.985L444.788 220.9a193.485 193.485 0 0 1 0 70.2zM336 256c0-44.112-35.888-80-80-80s-80 35.888-80 80 35.888 80 80 80 80-35.888 80-80z" />'},back:{viewbox:"0 0 512 512",content:'<path transform="translate(512, 0) scale(-1,1)" fill="currentColor" d="M503.691 189.836L327.687 37.851C312.281 24.546 288 35.347 288 56.015v80.053C127.371 137.907 0 170.1 0 322.326c0 61.441 39.581 122.309 83.333 154.132 13.653 9.931 33.111-2.533 28.077-18.631C66.066 312.814 132.917 274.316 288 272.085V360c0 20.7 24.3 31.453 39.687 18.164l176.004-152c11.071-9.562 11.086-26.753 0-36.328z" />'},trophy:{viewbox:"0 0 576 512",content:'<path fill="currentColor" d="M552 64H448V24c0-13.3-10.7-24-24-24H152c-13.3 0-24 10.7-24 24v40H24C10.7 64 0 74.7 0 88v56c0 66.5 77.9 131.7 171.9 142.4C203.3 338.5 240 360 240 360v72h-48c-35.3 0-64 20.7-64 56v12c0 6.6 5.4 12 12 12h296c6.6 0 12-5.4 12-12v-12c0-35.3-28.7-56-64-56h-48v-72s36.7-21.5 68.1-73.6C498.4 275.6 576 210.3 576 144V88c0-13.3-10.7-24-24-24zM64 144v-16h64.2c1 32.6 5.8 61.2 12.8 86.2-47.5-16.4-77-49.9-77-70.2zm448 0c0 20.2-29.4 53.8-77 70.2 7-25 11.8-53.6 12.8-86.2H512v16zm-127.3 4.7l-39.6 38.6 9.4 54.6c1.7 9.8-8.7 17.2-17.4 12.6l-49-25.8-49 25.8c-8.8 4.6-19.1-2.9-17.4-12.6l9.4-54.6-39.6-38.6c-7.1-6.9-3.2-19 6.7-20.5l54.8-8 24.5-49.6c4.4-8.9 17.1-8.9 21.5 0l24.5 49.6 54.8 8c9.6 1.5 13.5 13.6 6.4 20.5z" />'},cancel:{viewbox:"0 0 352 512",content:'<path fill="currentColor" d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z" />'},theme:{viewbox:"0 0 512 512",content:'<path fill="currentColor" d="M204.3 5C104.9 24.4 24.8 104.3 5.2 203.4c-37 187 131.7 326.4 258.8 306.7 41.2-6.4 61.4-54.6 42.5-91.7-23.1-45.4 9.9-98.4 60.9-98.4h79.7c35.8 0 64.8-29.6 64.9-65.3C511.5 97.1 368.1-26.9 204.3 5zM96 320c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm32-128c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128-64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z"/>'},reset:{viewbox:"0 0 512 512",content:'<path fill="currentColor" d="M370.72 133.28C339.458 104.008 298.888 87.962 255.848 88c-77.458.068-144.328 53.178-162.791 126.85-1.344 5.363-6.122 9.15-11.651 9.15H24.103c-7.498 0-13.194-6.807-11.807-14.176C33.933 94.924 134.813 8 256 8c66.448 0 126.791 26.136 171.315 68.685L463.03 40.97C478.149 25.851 504 36.559 504 57.941V192c0 13.255-10.745 24-24 24H345.941c-21.382 0-32.09-25.851-16.971-40.971l41.75-41.749zM32 296h134.059c21.382 0 32.09 25.851 16.971 40.971l-41.75 41.75c31.262 29.273 71.835 45.319 114.876 45.28 77.418-.07 144.315-53.144 162.787-126.849 1.344-5.363 6.122-9.15 11.651-9.15h57.304c7.498 0 13.194 6.807 11.807 14.176C478.067 417.076 377.187 504 256 504c-66.448 0-126.791-26.136-171.315-68.685L48.97 471.03C33.851 486.149 8 475.441 8 454.059V320c0-13.255 10.745-24 24-24z" />'},trash:{viewbox:"0 0 448 512",content:'<path fill="currentColor" d="M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z" />'}},convert:!0});const T={Menu:0,Playing:1,Complete:2,Stats:3,Prefs:4,Theme:5},w={Menu:["stats","prefs"],Playing:["back"],Complete:[],Stats:[],Prefs:["back","theme"],Theme:["back","reset"],None:[]},S=!0,I=!1;class wt{constructor(){this.dom={ui:document.querySelector(".ui"),game:document.querySelector(".ui__game"),back:document.querySelector(".ui__background"),prefs:document.querySelector(".ui__prefs"),theme:document.querySelector(".ui__theme"),stats:document.querySelector(".ui__stats"),texts:{title:document.querySelector(".text--title"),note:document.querySelector(".text--note"),timer:document.querySelector(".text--timer"),complete:document.querySelector(".text--complete"),best:document.querySelector(".text--best-time"),theme:document.querySelector(".text--theme")},buttons:{prefs:document.querySelector(".btn--prefs"),back:document.querySelector(".btn--back"),stats:document.querySelector(".btn--stats"),reset:document.querySelector(".btn--reset"),theme:document.querySelector(".btn--theme")}},this.world=new rt(this),this.cube=new ht(this),this.controls=new lt(this),this.scrambler=new ct(this),this.transition=new ut(this),this.timer=new mt(this),this.preferences=new gt(this),this.scores=new vt(this),this.storage=new bt(this),this.confetti=new pt(this),this.themes=new yt(this),this.themeEditor=new xt(this),this.initActions(),this.state=T.Menu,this.newGame=!1,this.saved=!1,this.storage.init(),this.preferences.init(),this.cube.init(),this.transition.init(),this.storage.loadGame(),this.scores.calcStats(),setTimeout(()=>{this.transition.float(),this.transition.cube(S),setTimeout(()=>this.transition.title(S),700),setTimeout(()=>this.transition.buttons(w.Menu,w.None),1e3)},500)}initActions(){let t=!1;this.dom.game.addEventListener("click",e=>{if(!(this.transition.activeTransitions>0)&&this.state!==T.Playing)if(this.state===T.Menu){if(!t)return t=!0,setTimeout(()=>t=!1,300),!1;this.game(S)}else this.state===T.Complete?this.complete(I):this.state===T.Stats&&this.stats(I)},!1),this.controls.onMove=()=>{this.newGame&&(this.timer.start(!0),this.newGame=!1)},this.dom.buttons.back.onclick=e=>{this.transition.activeTransitions>0||(this.state===T.Playing?this.game(I):this.state===T.Prefs?this.prefs(I):this.state===T.Theme&&this.theme(I))},this.dom.buttons.reset.onclick=e=>{this.state===T.Theme&&this.themeEditor.resetTheme()},this.dom.buttons.prefs.onclick=e=>this.prefs(S),this.dom.buttons.theme.onclick=e=>this.theme(S),this.dom.buttons.stats.onclick=e=>this.stats(S),this.controls.onSolved=()=>this.complete(S)}game(t){if(t){this.saved||(this.scrambler.scramble(),this.controls.scrambleCube(),this.newGame=!0);const e=this.saved?0:this.scrambler.converted.length*(this.controls.flipSpeeds[0]+10);this.state=T.Playing,this.saved=!0,this.transition.buttons(w.None,w.Menu),this.transition.zoom(T.Playing,e),this.transition.title(I),setTimeout(()=>{this.transition.timer(S),this.transition.buttons(w.Playing,w.None)},this.transition.durations.zoom-1e3),setTimeout(()=>{this.controls.enable(),this.newGame||this.timer.start(!0)},this.transition.durations.zoom)}else this.state=T.Menu,this.transition.buttons(w.Menu,w.Playing),this.transition.zoom(T.Menu,0),this.controls.disable(),this.newGame||this.timer.stop(),this.transition.timer(I),setTimeout(()=>this.transition.title(S),this.transition.durations.zoom-1e3),this.playing=!1,this.controls.disable()}prefs(t){if(t){if(this.transition.activeTransitions>0)return;this.state=T.Prefs,this.transition.buttons(w.Prefs,w.Menu),this.transition.title(I),this.transition.cube(I),setTimeout(()=>this.transition.preferences(S),1e3)}else this.cube.resize(),this.state=T.Menu,this.transition.buttons(w.Menu,w.Prefs),this.transition.preferences(I),setTimeout(()=>this.transition.cube(S),500),setTimeout(()=>this.transition.title(S),1200)}theme(t){if(this.themeEditor.colorPicker(t),t){if(this.transition.activeTransitions>0)return;this.cube.loadFromData(Et["3"].checkerboard),this.themeEditor.setHSL(null,!1),this.state=T.Theme,this.transition.buttons(w.Theme,w.Prefs),this.transition.preferences(I),setTimeout(()=>this.transition.cube(S,!0),500),setTimeout(()=>this.transition.theming(S),1e3)}else this.state=T.Prefs,this.transition.buttons(w.Prefs,w.Theme),this.transition.cube(I,!0),this.transition.theming(I),setTimeout(()=>this.transition.preferences(S),1e3),setTimeout(()=>{const e=JSON.parse(localStorage.getItem("theCube_savedState"));if(!e){this.cube.resize(!0);return}this.cube.loadFromData(e)},1500)}stats(t){if(t){if(this.transition.activeTransitions>0)return;this.state=T.Stats,this.transition.buttons(w.Stats,w.Menu),this.transition.title(I),this.transition.cube(I),setTimeout(()=>this.transition.stats(S),1e3)}else this.state=T.Menu,this.transition.buttons(w.Menu,w.None),this.transition.stats(I),setTimeout(()=>this.transition.cube(S),500),setTimeout(()=>this.transition.title(S),1200)}complete(t){if(t)this.transition.buttons(w.Complete,w.Playing),this.state=T.Complete,this.saved=!1,this.controls.disable(),this.timer.stop(),this.storage.clearGame(),this.bestTime=this.scores.addScore(this.timer.deltaTime),this.transition.zoom(T.Menu,0),this.transition.elevate(S),setTimeout(()=>{this.transition.complete(S,this.bestTime),this.confetti.start()},1e3);else return this.state=T.Stats,this.saved=!1,this.transition.timer(I),this.transition.complete(I,this.bestTime),this.transition.cube(I),this.timer.reset(),setTimeout(()=>{this.cube.reset(),this.confetti.stop(),this.transition.stats(S),this.transition.elevate(0)},1e3),!1}}window.game=new wt;
